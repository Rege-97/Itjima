<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itjima_server.mapper.ItemMapper">
  <insert id="insert" parameterType="com.itjima_server.domain.Item" useGeneratedKeys="true"
    keyProperty="id">
    INSERT INTO ITEMS (user_id, type, title, description)
    VALUES (#{userId}, #{type}, #{title}, #{description})
  </insert>
  <select id="findById" resultType="com.itjima_server.domain.Item">
    SELECT id, user_id, type, title, description, file_url, file_type, created_at
    FROM ITEMS
    WHERE id = #{id}
  </select>
  <update id="updateById" parameterType="com.itjima_server.domain.Item">
    UPDATE ITEMS
    SET title       = #{title},
        description = #{description},
        file_url    = #{fileUrl},
        file_type   = #{fileType}
    WHERE id = #{id}
  </update>
  <update id="updateFileById" parameterType="com.itjima_server.domain.Item">
    UPDATE ITEMS
    SET file_url  = #{fileUrl},
        file_type = #{fileType}
    WHERE id = #{id}
  </update>
  <select id="findByUserId" resultType="com.itjima_server.domain.Item">
    SELECT id,
    user_id,
    type,
    title,
    description,
    file_url,
    file_type,
    created_at
    FROM ITEMS
    WHERE
    user_id = #{userId}
    <if test="lastId != null">
      AND id &lt; #{lastId}
    </if>
    ORDER by id DESC
    LIMIT #{size}
  </select>
</mapper>